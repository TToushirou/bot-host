const botconfig = require("./botconfig.json");
const Discord = require("discord.js");
const tokenfile = require("./tokenfile.json");
const fs = require ('fs');


var bot = new Discord.Client({
    disableEveryone: true
});


bot.on('ready', () => {
    console.log("Bot Launched");
    bot.user.setGame('!bc for BotCommands');

});


bot.on('message', function (message) {
    if (message.author.bot) return;
    if (message.channel.type === "dm") return;

    let prefix = botconfig.prefix;
    let messageArray = message.content.split(" ");
    let cmd = messageArray[0];
    let args = messageArray.slice(1);

    if (cmd === `${prefix}bc`) {
            return message.channel.send('Bot Commands: ' + message.author + ' ``` 1). #bug-report !report *your bug report* ``` ``` 2). #cheater-report !creport *cheaters name, discription* ``` ')
        }

});

bot.on('message', function (message) {
    let prefix = botconfig.prefix;
    if (!message.content.startsWith(prefix) || message.author.bot) return;
    
    const args = message.content.slice(prefix.length).trim().split(/ +/g);
    const cmd = args.shift().toLowerCase();
    
    if (cmd === 'report') {
        if (!args.length) {
            return message.channel.send(`You didn't provide any arguments, ${message.author}! please try again.`);
        }

        let input = args.join(" ");
        message.delete();



        let bugreport = new Discord.RichEmbed()
            .setAuthor("Bug Report")
            .setColor("#009dff")
            .setThumbnail(`${message.author.avatarURL}`)
            .addField("Description:", input)
            .setImage('https://cdn.discordapp.com/icons/522174782658183259/f219b7347edade2c83d2b6a7f364a198.png')
            .setTimestamp()
            .setFooter(`Reported By: ${message.author.tag}`, `${message.author.avatarURL}`);


        message.channel.send(bugreport)
        return;

    }
});

bot.on('message', function (message) {
    let prefix = botconfig.prefix;
    if (!message.content.startsWith(prefix) || message.author.bot) return;

    const args1 = message.content.slice(prefix.length).trim().split(/ +/g);
    const cmd1 = args1.shift().toLowerCase();

    if (cmd1 === 'creport') {
        if (!args1.length) {
            return message.channel.send(`You didn't provide any arguments, ${message.author}! please try again.`);
        }

        let input1 = args1.join(" ");
        message.delete();



        let cheaterreport = new Discord.RichEmbed()
            .setAuthor("Cheater Report")
            .setColor("#ff0808")
            .setThumbnail(`${message.author.avatarURL}`)
            .addField("Description:", input1)
            .setImage('https://cdn.discordapp.com/icons/522174782658183259/f219b7347edade2c83d2b6a7f364a198.png')
            .setTimestamp()
            .setFooter(`Reported By: ${message.author.tag}`, `${message.author.avatarURL}`);


        message.channel.send(cheaterreport)
        return;

    }
});

bot.on('message', function (message) {
    if (message.author.bot) return;
    if (message.channel.type === "dm") return;

    let prefix = botconfig.prefix;
    let messageArray = message.content.split(" ");
    let cmd = messageArray[0];
    let args = messageArray.slice(1);

    if (cmd === `${prefix}kick`) {
        let kUser = message.guild.member(message.mentions.users.first() || message.guild.members.get(args[0]));
        if (!kUser) return message.channel.send("Cant find user!");
        let kReason = args.join(" ").slice(22);
        if (!message.member.hasPermission("MANAGE_MESSAGES")) return message.channel.send(`${message.author}, *You Dont Have The* **Power**!`);
        if (kUser.hasPermission("MANAGE_MESSAGES")) return message.channel.send(`${message.author}, **That's One Of Our Own**!!`);

        let kickembed = new Discord.RichEmbed()
            .setDescription("~Kick~")
            .setColor("#ffae00")
            .addField("Kicked User", `${kUser} With ID ${kUser.id}`)
            .addField("Kicked By", `<@${message.author.id}> with ID ${message.author.id}`)
            .addField("Kicked in", message.channel)
            .addField("Time", message.createdAt)
            .addField("Reason", kReason);

        let kickchannel = message.guild.channels.find(`name`, "hall-of-shame");
        if (!kickchannel) return message.channel.send("Can't find channel");

        message.guild.member(kUser).kick(kReason);

        kickchannel.send(kickembed);
        return;
    }
});
            




bot.login(process.env.tokenfile.token);


